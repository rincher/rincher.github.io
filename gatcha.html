<html>
    <head>
        <!-- Theme CSS -->
        <link id="theme-style" rel="stylesheet" href="assets/css/theme-1.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

        <!-- Jquery CDN -->
        <script
            src="https://code.jquery.com/jquery-3.6.0.js"
            integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
            crossorigin="anonymous"
        ></script>
        <script>
            function newGatcha(){
                $("#result").empty();
                let username = $("#userName").val()
                let gamename = $("#gameName").val()
                let moneyspent = $('#moneySpent').val()
                $.ajax({
                    type : "POST",
                    url : "http://localhost:8080/gatcha/new",
                    contentType : "application/json",
                    data : JSON.stringify({
                        userName : username,
                        gameName : gamename,
                        moneySpent : moneyspent
                    }),
                    success: function (response){
                        let result = response;
                        console.log(response)
                        let temp_html = `<p> ${result}</p>`;
                        $('#result').append(temp_html);
                    }
                })
            }

            function updateGatcha(){
                $("#result").empty();
                let username = $("#userName").val()
                let gamename = $("#gameName").val()
                let moneySpent = $('#moneySpent').val()
                $.ajax({
                    type : "POST",
                    url : "http://localhost:8080/gatcha/update",
                    contentType : "application/json",
                    data : JSON.stringify({
                        userName : username,
                        gameName : gamename,
                        moneySpent : moneySpent
                    }),
                    success : function(response){
                        let result = response;
                        console.log(response)
                        let temp_html = `<p> ${result} </p>`;
                        $('#result').append(temp_html);
                    }
                })
            }

            function queryGatcha(){
                $("#result").empty();
                let username = $("#userName").val()
                let query = $("#query").val()
                $.ajax({
                    type : "POST",
                    url : "http://localhost:8080/gatcha/exchange",
                    contentType : "application/json",
                    data : JSON.stringify({
                        userName : username,
                        query : query
                    }),
                    success : function (response){
                        console.log(response)
                        
                        for (const [key,value] of Object.entries(response)){
                            let temp_html = `<p> ${key} : ${value} </p>`;
                            $('#result').append(temp_html);
                        }    
                    }
                })
            }

            function getTotal(){
                $("#result").empty();
                let username = $("#userName").val()
                $.ajax({
                    type : "POST",
                    url : "http://localhost:8080/gatcha/total",
                    contentType : "application/json",
                    data : JSON.stringify({
                        userName : username
                    }),
                    success : function (response){
                        let totalPrice = response.toLocaleString();
                        console.log(response);
                        let temp_html = `<p> ${totalPrice} </p>`;
                        $("#result").append(temp_html);
                    }
                })
            }

            function getGameList(){
                let username = $("#userName").val()
                $.ajax({
                    type : "POST",
                    url : "http://localhost:8080/gatcha/gameList",
                    contentType : "application/json",
                    data : JSON.stringify({
                        userName : username
                    }),
                    success : function(response){
                        console.log(response)
                        response.forEach(element => {
                            console.log(element)
                        });
                    }
                })
            }
        </script>
    </head>
    <body>
        <div>
            <h1> New Gatcha </h1>
            userName <input type="text" id="userName">
            gameName <input type="text" id="gameName">
            moneySpent <input type="number" id="moneySpent" placeholder="1000 = 1">
            Query <input type="text" id="query">
        <button onclick="newGatcha()" class="btn btn-primary">new</button>
        <button onclick="updateGatcha()" class="btn btn-primary">update</button>
        <button onclick="getTotal()" class="btn btn-primary">total</button>
        <button onclick="queryGatcha()" class="btn btn-primary">query</button>
        <button onclick="getGameList()" class="btn btn-primary"> gameList</button>

        <div id="result">
            <p id="test"></p>
            
        </div>
    </body>
</html>